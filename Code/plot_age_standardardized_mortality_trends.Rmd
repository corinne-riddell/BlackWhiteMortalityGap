---
title: "Untitled"
author: "Corinne Riddell"
date: "2/8/2017"
output: html_document
---

```{r load_libraries, echo=FALSE, warning=F, message=F}
library(dplyr)
library(purrr)
library(ggplot2)
library(stringr)
library(reshape2)
library(grid)
library(gridExtra)
library(plotly)
```

```{r, echo=F}
mortality.rates <- read.csv("/Users/corinneriddell/Documents/repos/BlackWhiteMortalityGap/Data/mortality_rates.csv")
```

**MALES**

**Fig S3: Age-adjusted cancer-related mortality (per 100,000) in males, United States, 1969-2013**

```{r, echo=F, fig.width=11, fig.height=9}
ggplotly(ggplot(subset(mortality.rates, sex == "Male" & post.samp == 1 & COD == "Cancers"), aes(y=rate.per.100k, x = year)) + 
           geom_vline(aes(xintercept = 1983), col = "#636363", lwd = 0.5) +
           geom_vline(aes(xintercept = 1993), col = "#636363", lwd = 0.5) +
           geom_line(aes(col = state, lty = race)) +
           facet_wrap( ~ state, ncol = 5) +
           ylab("Age-standardized mortality rate (per 100,000)") +
           xlab("Year"))
```

**Fig S4: Age-adjusted cardiovascular-related mortality (per 100,000) in males, United States, 1969-2013**

```{r, echo=F, fig.width=11, fig.height=9}
ggplotly(ggplot(subset(mortality.rates, sex == "Male" & post.samp == 1 & COD == "Cardiovascular"), aes(y=rate.per.100k, x = year)) + 
           geom_vline(aes(xintercept = 1983), col = "#636363", lwd = 0.5) +
           geom_vline(aes(xintercept = 1993), col = "#636363", lwd = 0.5) +
           geom_line(aes(col = state, lty = race)) +
           facet_wrap( ~ state, ncol = 5) +
           ylab("Age-standardized mortality rate (per 100,000)") +
           xlab("Year"))
```

**Fig S5: Age-adjusted communicable disease-related mortality (per 100,000) in males, United States, 1969-2013**

```{r, echo=F, fig.width=11, fig.height=9}
ggplotly(ggplot(subset(mortality.rates, sex == "Male" & post.samp == 1 & COD == "Communicable"), aes(y=rate.per.100k, x = year)) + 
           geom_vline(aes(xintercept = 1983), col = "#636363", lwd = 0.5) +
           geom_vline(aes(xintercept = 1993), col = "#636363", lwd = 0.5) +
           geom_line(aes(col = state, lty = race)) +
           facet_wrap( ~ state, ncol = 5) +
           ylab("Age-standardized mortality rate (per 100,000)") +
           xlab("Year"))
```

**Fig S6: Age-adjusted injury-related mortality (per 100,000) in males, United States, 1969-2013**

```{r, echo=F, fig.width=11, fig.height=9}
ggplotly(ggplot(subset(mortality.rates, sex == "Male" & post.samp == 1 & COD == "Injuries"), aes(y=rate.per.100k, x = year)) + 
           geom_vline(aes(xintercept = 1983), col = "#636363", lwd = 0.5) +
           geom_vline(aes(xintercept = 1993), col = "#636363", lwd = 0.5) +
           geom_line(aes(col = state, lty = race)) +
           facet_wrap( ~ state, ncol = 5) +
           ylab("Age-standardized mortality rate (per 100,000)") +
           xlab("Year"))
```

**Fig S7: Age-adjusted non-communicable disease-related mortality (per 100,000) in males, United States, 1969-2013**

```{r, echo=F, fig.width=11, fig.height=9}
ggplotly(ggplot(subset(mortality.rates, sex == "Male" & post.samp == 1 & COD == "Non-communicable"), aes(y=rate.per.100k, x = year)) + 
           geom_vline(aes(xintercept = 1983), col = "#636363", lwd = 0.5) +
           geom_vline(aes(xintercept = 1993), col = "#636363", lwd = 0.5) +
           geom_line(aes(col = state, lty = race)) +
           facet_wrap( ~ state, ncol = 5) +
           ylab("Age-standardized mortality rate (per 100,000)") +
           xlab("Year"))
```

**Fig S8: Age-adjusted mortality (per 100,000) in males for all other causes, United States, 1969-2013**

```{r, echo=F, fig.width=11, fig.height=9}
ggplotly(ggplot(subset(mortality.rates, sex == "Male" & post.samp == 1 & COD == "All other causes"), aes(y=rate.per.100k, x = year)) + 
           geom_vline(aes(xintercept = 1983), col = "#636363", lwd = 0.5) +
           geom_vline(aes(xintercept = 1993), col = "#636363", lwd = 0.5) +
           geom_line(aes(col = state, lty = race)) +
           facet_wrap( ~ state, ncol = 5) +
           ylab("Age-standardized mortality rate (per 100,000)") +
           xlab("Year"))
```

**FEMALES**

**Fig S9: Age-adjusted cancer-related mortality (per 100,000) in females, United States, 1969-2013**

```{r, echo=F, fig.width=11, fig.height=9}
ggplotly(ggplot(subset(mortality.rates, sex == "Female" & post.samp == 1 & COD == "Cancers"), aes(y=rate.per.100k, x = year)) + 
           geom_vline(aes(xintercept = 1983), col = "#636363", lwd = 0.5) +
           geom_vline(aes(xintercept = 1993), col = "#636363", lwd = 0.5) +
           geom_line(aes(col = state, lty = race)) +
           facet_wrap( ~ state, ncol = 5) +
           ylab("Age-standardized mortality rate (per 100,000)") +
           xlab("Year"))
```

**Fig S10: Age-adjusted cardiovascular-related mortality (per 100,000) in females, United States, 1969-2013**

```{r, echo=F, fig.width=11, fig.height=9}
ggplotly(ggplot(subset(mortality.rates, sex == "Female" & post.samp == 1 & COD == "Cardiovascular"), aes(y=rate.per.100k, x = year)) + 
           geom_vline(aes(xintercept = 1983), col = "#636363", lwd = 0.5) +
           geom_vline(aes(xintercept = 1993), col = "#636363", lwd = 0.5) +
           geom_line(aes(col = state, lty = race)) +
           facet_wrap( ~ state, ncol = 5) +
           ylab("Age-standardized mortality rate (per 100,000)") +
           xlab("Year"))
```

**Fig S11: Age-adjusted communicable disease-related mortality (per 100,000) in females, United States, 1969-2013**

```{r, echo=F, fig.width=11, fig.height=9}
ggplotly(ggplot(subset(mortality.rates, sex == "Female" & post.samp == 1 & COD == "Communicable"), aes(y=rate.per.100k, x = year)) + 
           geom_vline(aes(xintercept = 1983), col = "#636363", lwd = 0.5) +
           geom_vline(aes(xintercept = 1993), col = "#636363", lwd = 0.5) +
           geom_line(aes(col = state, lty = race)) +
           facet_wrap( ~ state, ncol = 5) +
           ylab("Age-standardized mortality rate (per 100,000)") +
           xlab("Year"))
```

**Fig S12: Age-adjusted injury-related mortality (per 100,000) in females, United States, 1969-2013**

```{r, echo=F, fig.width=11, fig.height=9}
ggplotly(ggplot(subset(mortality.rates, sex == "Female" & post.samp == 1 & COD == "Injuries"), aes(y=rate.per.100k, x = year)) + 
           geom_vline(aes(xintercept = 1983), col = "#636363", lwd = 0.5) +
           geom_vline(aes(xintercept = 1993), col = "#636363", lwd = 0.5) +
           geom_line(aes(col = state, lty = race)) +
           facet_wrap( ~ state, ncol = 5) +
           ylab("Age-standardized mortality rate (per 100,000)") +
           xlab("Year"))
```

**Fig S13: Age-adjusted non-communicable disease-related mortality (per 100,000) in females, United States, 1969-2013**

```{r, echo=F, fig.width=11, fig.height=9}
ggplotly(ggplot(subset(mortality.rates, sex == "Female" & post.samp == 1 & COD == "Non-communicable"), aes(y=rate.per.100k, x = year)) + 
           geom_vline(aes(xintercept = 1983), col = "#636363", lwd = 0.5) +
           geom_vline(aes(xintercept = 1993), col = "#636363", lwd = 0.5) +
           geom_line(aes(col = state, lty = race)) +
           facet_wrap( ~ state, ncol = 5) +
           ylab("Age-standardized mortality rate (per 100,000)") +
           xlab("Year"))
```

**Fig S14: Age-adjusted mortality (per 100,000) in females for all other causes, United States, 1969-2013**

```{r, echo=F, fig.width=11, fig.height=9}
ggplotly(ggplot(subset(mortality.rates, sex == "Female" & post.samp == 1 & COD == "All other causes"), aes(y=rate.per.100k, x = year)) + 
           geom_vline(aes(xintercept = 1983), col = "#636363", lwd = 0.5) +
           geom_vline(aes(xintercept = 1993), col = "#636363", lwd = 0.5) +
           geom_line(aes(col = state, lty = race)) +
           facet_wrap( ~ state, ncol = 5) +
           ylab("Age-standardized mortality rate (per 100,000)") +
           xlab("Year"))
```

