library(plyr)
library(dplyr)
library(ggplot2)
library(tidyr)
load("/Users/corinneriddell/Dropbox/BlackWhiteGap/Data/alabama_only.Rdata")
View(dat.clean.alabama)
alabama.by.strata <-
dat.clean.alabama %>% group_by(Year2, RaceSex, Age2) %>%
arrange(RaceSex, Year2, Age2) %>%
summarise(total_deaths5 = sum(Count_md5),
Population = first(Population),
Race2 = first(Race2),
Sex2 = first(Sex2),
StateYearRaceSex = first(StateYearRaceSex))
head(alabama.by.strata)
View(alabama.by.strata)
life.table <- function(data.frame, years, age.groups, death.counts, population.counts){
retunr(head(data.frame[[years]]))
}
life.table(alabama.by.strata, Year2, Age2, total_deaths5, Population)
life.table <- function(data.frame, years, age.groups, death.counts, population.counts){
return(head(data.frame[[years]]))
}
life.table(alabama.by.strata, Year2, Age2, total_deaths5, Population)
life.table <- function(data.frame, years, age.groups, death.counts, population.counts){
return(head(data.frame[years]))
}
life.table(alabama.by.strata, Year2, Age2, total_deaths5, Population)
life.table <- function(data.frame, years, age.groups, death.counts, population.counts){
return(head(data.frame[years]))
}
life.table(alabama.by.strata, Year2, Age2, total_deaths5, Population)
life.table(alabama.by.strata, "Year2", "Age2", "total_deaths5", "Population")
B:J
for letter in c("B", "C", "D") {
for (letter in c("B", "C", "D")) {
rv <- runif(1, 0, 1)
new.var <- ifelse(rv < 0.3, 1, 0)
assign(letter, new.var)
}
for (letter in c("X", "Y", "Z")){
rand.norm <- rnorm(1, 0, 1)
assign(letter, rand.norm)
}
c(X, Y, Z)
for (letter in c("X", "Y", "Z")){
rand.norm <- rnorm(1, 0, 1)
assign(letter, rand.norm)
new.var <- paste0(letter,  1)
assign(new.var, -rand.norm)
}
c(X, Y, Z)
c(X1, Y2, Z3)
c(X1, Y1, Z1)
rx <- 0.002
val <- rx/(1 + 0.5*rx)
val*(2-val)
2*rx/(1 + 0.5*2*rx)
rx*(1 + (1-rx) + (1-rx)^2)
3*rx/(1 + 0.5*3*rx)
rx*(1 + (1-rx) + (1-rx)^2 + (1-rx)^4 + (1-rx)^4)
5*rx/(1 + 0.5*5*rx)
quit
quit()
library(plyr)
library(dplyr)
library(ggplot2)
library(tidyr)
library(scales)
load(file = "/Users/corinneriddell/Dropbox/BlackWhiteGap/Data/Sep6_BWgap.Rdata")
dat3 <-
dat2 %>% group_by(StateYearRaceSex) %>%
arrange(Age2) %>%
summarise(State2 = first(State2), Year2 = first(Year2), Race2 = first(Race2), Sex2 = first(Sex2),
Pop_across_age = sum(Population, na.rm = "always"), Pop_has_NA = sum(Population),
LE_birth1 = first(life_exp1), LE_birth5 = first(life_exp5), LE_birth9 = first(life_exp9),
LE_birthb9 = first(life_expb9), LE_birthw9 = first(life_expw9))
dat3$grouping <- interaction(dat3$State2, dat3$Race2, dat3$Sex2)
dat3$Year <- as.numeric(as.character(dat3$Year2))
#life expectancy over time under two sensitivities for imputing the NA death counts
ggplot(subset(dat3, State2 == "Alabama"), aes(y = LE_birth1, x = Year)) +
geom_line(aes(col = grouping, lty = "Imputed 1")) +
geom_line(aes(y = LE_birth9, col = grouping, lty = "Imputed 9")) +
# geom_line(aes(y = LE_birthb9, col = grouping, lty = "Imputed w=1, b=9")) +
ylab("Life Expectancy at Birth") + scale_x_continuous(breaks = seq(1969, 2013, by = 4)) +
scale_y_continuous(breaks = seq(55, 90, by = 2)) +
facet_wrap(~ Sex2)
ggplot(subset(dat3, State2 == "Alabama"), aes(y = LE_birth1, x = Year)) +
geom_line(aes(col = grouping)) +
ylab("Life Expectancy at Birth") + scale_x_continuous(breaks = seq(1969, 2013, by = 4)) +
scale_y_continuous(breaks = seq(55, 90, by = 2)) +
facet_wrap(~ Sex2)
quit()
